# Phase 6: User Story 4 測試指南

## 已實作功能概述

### T071-T074: 單元選擇器元件
- ✅ 多選 checkbox 單元選擇器（依 category 分組）
- ✅ 可摺疊群組設計
- ✅ 使用 UnitStorage.getAllUnits() 載入所有單元
- ✅ 多選邏輯處理

### T075-T078: 照片卡片單元顯示
- ✅ 照片卡片編輯模式（編輯按鈕）
- ✅ 單元選擇器 Modal
- ✅ 儲存單元處理器
- ✅ 照片卡片上顯示已分配的單元（彩色標籤）
- ✅ 單元徽章樣式

### T079-T081: 自訂單元建立
- ✅ 自訂單元建立表單
- ✅ 自訂單元建立處理器
- ✅ 建立後自動加入單元選擇器

### T082-T086: 篩選面板與整合
- ✅ 篩選面板元件（包含單元篩選 UI）
- ✅ 篩選面板樣式（響應式設計）
- ✅ 單元篩選邏輯
- ✅ 篩選面板連接到照片列表
- ✅ 篩選面板已整合到主頁面

## 測試步驟

### 1. 啟動本地伺服器

```bash
cd /workspaces/answer/frontend
python3 -m http.server 8080
```

瀏覽器開啟：`http://localhost:8080/src/index.html`

### 2. 測試單元選擇器

#### 2.1 檢視預設單元
1. 開啟頁面後，應該看到篩選面板
2. 點擊 "📂 依單元篩選" 區域
3. 應該看到以下分類群組：
   - 數學 (3 個單元)
   - 物理 (2 個單元)
   - 化學 (2 個單元)
4. 點擊分類名稱可以展開/收合單元列表

#### 2.2 測試單元篩選
1. 勾選一個或多個單元（例如：數學代數、物理力學）
2. 照片列表應該只顯示包含這些單元的照片
3. 點擊 "清除" 按鈕應該取消所有篩選
4. 照片列表應該恢復顯示所有照片

### 3. 測試自訂單元建立

#### 3.1 建立自訂單元
1. 在篩選面板中點擊 "+ 新增自訂單元" 按鈕
2. 輸入單元名稱（例如：英文文法）
3. 輸入分類（例如：英文）
4. 點擊 "儲存"
5. 應該看到成功訊息
6. 新單元應該出現在對應分類下，並標示 "自訂" 標籤

#### 3.2 驗證自訂單元
1. 新建立的單元應該立即出現在篩選面板中
2. 如果是新分類，應該建立新的分類群組
3. 自訂單元應該有 "自訂" 橘色標籤

### 4. 測試照片單元分配

#### 4.1 上傳測試照片
1. 點擊上傳按鈕，選擇一張照片上傳
2. 等待照片上傳完成

#### 4.2 分配單元
1. 將滑鼠移到照片卡片上
2. 應該看到右上角出現編輯按鈕（✏️）和刪除按鈕（×）
3. 點擊編輯按鈕
4. 應該開啟 "編輯照片資訊" Modal
5. 在 Modal 中可以看到所有可用的單元（依分類分組）
6. 勾選一個或多個單元（例如：數學代數、數學幾何）
7. 點擊 "儲存"
8. Modal 應該關閉
9. 應該看到成功訊息

#### 4.3 驗證單元顯示
1. 照片卡片下方應該顯示已分配的單元（藍色標籤）
2. 單元名稱應該簡潔顯示（例如："代數"、"幾何"）
3. 多個單元應該並排顯示

### 5. 測試篩選功能整合

#### 5.1 基本篩選
1. 上傳多張照片
2. 為不同照片分配不同單元
3. 在篩選面板中勾選特定單元
4. 應該只看到包含該單元的照片
5. 未勾選的照片應該被隱藏

#### 5.2 多選篩選（OR 邏輯）
1. 勾選多個單元（例如：數學代數 + 物理力學）
2. 應該顯示包含任一單元的照片
3. 即使照片只有其中一個單元也會顯示

#### 5.3 空白結果處理
1. 勾選沒有照片使用的單元
2. 應該顯示 "沒有符合條件的照片" 訊息
3. 提示 "試試調整篩選條件"

### 6. 測試編輯功能

#### 6.1 修改已分配的單元
1. 點擊已分配單元的照片的編輯按鈕
2. Modal 中應該顯示已勾選的單元
3. 可以勾選新單元或取消勾選現有單元
4. 儲存後單元標籤應該更新

#### 6.2 移除所有單元
1. 開啟照片編輯 Modal
2. 取消勾選所有單元
3. 儲存
4. 照片卡片不應該顯示單元標籤

### 7. 測試響應式設計

#### 7.1 桌面視圖（>1024px）
1. 篩選面板應該在照片列表上方
2. 單元選擇器應該清晰易讀
3. 照片卡片應該以網格排列

#### 7.2 平板視圖（640-1024px）
1. 篩選面板應該自適應寬度
2. 照片網格應該調整列數

#### 7.3 手機視圖（<640px）
1. 篩選面板應該佔滿寬度
2. 編輯 Modal 應該佔滿螢幕（95vw）
3. 編輯和刪除按鈕應該稍微調整位置
4. 照片網格應該單列顯示

### 8. 測試錯誤處理

#### 8.1 重複單元名稱
1. 嘗試建立已存在的單元（相同分類+名稱）
2. 應該顯示錯誤訊息："「分類」中已有「名稱」單元"

#### 8.2 空白表單
1. 點擊 "+ 新增自訂單元"
2. 不輸入任何內容直接點擊儲存
3. 應該顯示錯誤訊息："請輸入單元名稱和分類"

### 9. 測試使用者體驗

#### 9.1 視覺回饋
- ✅ 滑鼠移到照片卡片時，編輯和刪除按鈕淡入
- ✅ 勾選單元時，checkbox 狀態即時更新
- ✅ 篩選變更時，照片列表平滑更新
- ✅ 成功/錯誤訊息顯示 3 秒後自動消失

#### 9.2 互動性
- ✅ 點擊分類可以展開/收合
- ✅ 點擊照片卡片（非按鈕區域）開啟大圖
- ✅ 點擊編輯按鈕開啟編輯 Modal
- ✅ ESC 鍵關閉 Modal
- ✅ 點擊 Modal 背景關閉 Modal

## 已知問題與限制

1. **篩選面板位置**：目前在照片列表上方，未來可考慮側邊欄設計
2. **單元名稱顯示**：目前使用簡化顯示（從 ID 提取），可考慮儲存完整名稱映射
3. **批次操作**：目前一次只能編輯一張照片，未來可考慮批次分配單元

## 效能考量

- ✅ 使用 IndexedDB 本地儲存，無需網路請求
- ✅ 篩選邏輯在客戶端執行，即時響應
- ✅ 單元列表快取在元件中，避免重複查詢
- ✅ 照片縮圖使用 lazy loading

## 瀏覽器相容性

測試過的瀏覽器：
- Chrome 90+
- Safari 14+
- Firefox 88+
- Edge 90+

## 下一階段

Phase 7: User Story 5 - 為錯題添加標籤
- T087-T098：標籤輸入、顯示、篩選功能
